@page
@model WebAppRazor.Web.Pages.Subscription.IndexModel
@{
    ViewData["Title"] = "Nâng cấp gói";
}

<h2 class="section-title text-center mb-4"><i class="fas fa-crown me-2"></i>Nâng cấp gói dịch vụ</h2>

@if (!string.IsNullOrEmpty(Model.SuccessMessage))
{
    <div class="alert alert-success text-center"><i class="fas fa-check-circle me-2"></i>@Model.SuccessMessage</div>
}
@if (!string.IsNullOrEmpty(Model.ErrorMessage))
{
    <div class="alert alert-danger text-center"><i class="fas fa-exclamation-circle me-2"></i>@Model.ErrorMessage</div>
}

@if (Model.CurrentTier == "BasicPremium")
{
    <div class="text-center mb-4">
        <div class="badge bg-warning text-dark p-3 fs-5">
            <i class="fas fa-crown me-2"></i>Bạn đang sử dụng gói Basic Premium
        </div>
        @if (Model.ExpiresAt.HasValue)
        {
            <p class="mt-2 text-muted">Hết hạn: @Model.ExpiresAt.Value.ToString("dd/MM/yyyy")</p>
        }
    </div>
}

<div class="row justify-content-center g-4 mb-5">
    <!-- Free Plan -->
    <div class="col-md-4">
        <div class="card pricing-card @(Model.CurrentTier == "Free" ? "active-plan" : "")">
            <div class="card-body text-center p-4">
                <div class="pricing-icon mb-3">
                    <i class="fas fa-seedling fa-3x text-success"></i>
                </div>
                <h4 class="fw-bold">Miễn phí</h4>
                <div class="pricing-amount mb-3">
                    <span class="fs-1 fw-bold">0đ</span>
                    <span class="text-muted">/mãi mãi</span>
                </div>
                <ul class="list-unstyled text-start mb-4">
                    <li class="mb-2"><i class="fas fa-check text-success me-2"></i>Tính toán BMI, BMR, TDEE</li>
                    <li class="mb-2"><i class="fas fa-check text-success me-2"></i>AI tạo thực đơn cơ bản</li>
                    <li class="mb-2"><i class="fas fa-check text-success me-2"></i>Theo dõi tiến trình</li>
                    <li class="mb-2"><i class="fas fa-check text-success me-2"></i>Đánh giá món ăn</li>
                    <li class="mb-2 text-muted"><i class="fas fa-times text-danger me-2"></i>Tùy chỉnh menu</li>
                    <li class="mb-2 text-muted"><i class="fas fa-times text-danger me-2"></i>Thông tin dinh dưỡng chi tiết</li>
                    <li class="mb-2 text-muted"><i class="fas fa-times text-danger me-2"></i>Hướng dẫn nấu ăn</li>
                </ul>
                @if (Model.CurrentTier == "Free")
                {
                    <button class="btn btn-outline-success btn-lg w-100" disabled>
                        <i class="fas fa-check me-1"></i> Gói hiện tại
                    </button>
                }
            </div>
        </div>
    </div>

    <!-- Basic Premium Plan -->
    <div class="col-md-4">
        <div class="card pricing-card premium @(Model.CurrentTier == "BasicPremium" ? "active-plan" : "")">
            <div class="ribbon" style="@(Model.CurrentTier != "BasicPremium" ? "" : "display:none")">Phổ biến nhất</div>
            <div class="card-body text-center p-4">
                <div class="pricing-icon mb-3">
                    <i class="fas fa-crown fa-3x text-warning"></i>
                </div>
                <h4 class="fw-bold">Basic Premium</h4>
                <div class="pricing-amount mb-3">
                    <span class="fs-1 fw-bold text-warning">99K đ</span>
                    <span class="text-muted">/tháng</span>
                </div>
                <ul class="list-unstyled text-start mb-4">
                    <li class="mb-2"><i class="fas fa-check text-success me-2"></i>Tất cả tính năng Miễn phí</li>
                    <li class="mb-2"><i class="fas fa-check text-warning me-2"></i><strong>Tùy chỉnh menu</strong></li>
                    <li class="mb-2"><i class="fas fa-check text-warning me-2"></i><strong>Thông tin dinh dưỡng chi tiết</strong></li>
                    <li class="mb-2"><i class="fas fa-check text-warning me-2"></i><strong>Hướng dẫn nấu ăn từng món</strong></li>
                    <li class="mb-2"><i class="fas fa-check text-warning me-2"></i><strong>Danh sách nguyên liệu</strong></li>
                    <li class="mb-2"><i class="fas fa-check text-warning me-2"></i>Ưu tiên hỗ trợ</li>
                </ul>

                @if (Model.CurrentTier != "BasicPremium")
                {
                    <div class="d-grid gap-2">
                        <form method="post" asp-page-handler="Upgrade">
                            <input type="hidden" name="planType" value="Weekly" />
                            <button type="submit" class="btn btn-outline-warning w-100 mb-2">
                                <i class="fas fa-bolt me-1"></i> Gói Tuần - 39K đ
                            </button>
                        </form>
                        <form method="post" asp-page-handler="Upgrade">
                            <input type="hidden" name="planType" value="Monthly" />
                            <button type="submit" class="btn btn-warning w-100 btn-lg mb-2">
                                <i class="fas fa-crown me-1"></i> Gói Tháng - 99K đ
                            </button>
                        </form>
                        <form method="post" asp-page-handler="Upgrade">
                            <input type="hidden" name="planType" value="Yearly" />
                            <button type="submit" class="btn btn-outline-warning w-100">
                                <i class="fas fa-gem me-1"></i> Gói Năm - 799K đ
                            </button>
                        </form>
                    </div>
                }
                else
                {
                    <button class="btn btn-warning btn-lg w-100" disabled>
                        <i class="fas fa-check me-1"></i> Gói hiện tại
                    </button>
                }
            </div>
        </div>
    </div>
</div>
